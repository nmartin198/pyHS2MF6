
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3.2. Standalone HSPF Model &#8212; pyHS2MF6 0.1.1 documentation</title>
    <link rel="stylesheet" href="_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="3.3. Standalone MODFLOW 6 Model" href="cs_sa_MF6.html" />
    <link rel="prev" title="3.1. Study Site" href="cs_study_site.html" /> 
  </head><body>
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="index.html">pyHS2MF6 0.1.1 documentation</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="cs_study_site.html" title="3.1. Study Site"
             accesskey="P">previous</a> |
          <a href="cs_sa_MF6.html" title="3.3. Standalone MODFLOW 6 Model"
             accesskey="N">next</a> |
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |
          <a href="f-modindex.html" title="Fortran Module Index"
             >fortran modules</a> |
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="standalone-hspf-model">
<span id="standalone-hspf"></span><h1><span class="section-number">3.2. </span>Standalone HSPF Model<a class="headerlink" href="#standalone-hspf-model" title="Permalink to this headline">¶</a></h1>
<p>The case study application was developed to assist in pyHS2MF6
development and testing. Consequently, there was not an existing
HSPF model to use as a starting point. However, a standalone
HSPF model was created expressly for testing pyHS2MF6.</p>
<p><strong>mHSP2</strong> is the name of the standalone HSPF component of pyHS2MF6.
The <strong>mHSP2</strong> code base is documented in <a class="reference internal" href="mHSP2.html#mhsp2"><span class="std std-ref">mHSP2</span></a>. It uses the
same input file format as used by the
<a class="reference external" href="https://github.com/respec/HSPsquared">HSPsquared</a> variant of HSPF.</p>
<p>The <strong>mHSP2</strong> input file for the case study is a
<a class="reference external" href="https://portal.hdfgroup.org/display/knowledge/What+is+HDF5">HDF5 file</a>.
This <a class="reference external" href="https://github.com/nmartin198/pyHS2MF6/blob/master/example_models/standalone/HSPF/DC_Subs_12_mHSP2_PreAutoCal.h5">standalone mHSP2 input file</a>
is available on the pyHS2MF6 GitHub site.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="hspf-model-layout-and-configuration">
<span id="cs-sahspf-model"></span><h2><span class="section-number">3.2.1. </span>HSPF Model Layout and Configuration<a class="headerlink" href="#hspf-model-layout-and-configuration" title="Permalink to this headline">¶</a></h2>
<p>The site watershed was divided into 12 sub-watershed,
<abbr title="Hydrologic Response Units">HRUs</abbr>. Each HRU has PERLND, pervious
land, and IMPLND, impervious land, components or areas. IMPLND areas are
composed of gravel roads and structures. Given the limited development
in this area, the pervious land area is <code class="docutils literal notranslate"><span class="pre">&gt;&gt;</span></code> impervious land area.</p>
<p>Five RCHRES, stream reach or well mixed reservoirs, are used to route
water from the upstream-most <abbr title="Hydrologic Response Unit">HRU</abbr> to
the watershed outlet. RCHRES #5 is the stream segment where the stream
gage and the springs are located.</p>
<p>Figure <a class="reference internal" href="#fig-cs-sahspf"><span class="std std-ref">HSPF model configuration</span></a> shows the HSPF model layout for the study
site. Complete details of HSPF model configuration are available in
the <a class="reference external" href="https://github.com/nmartin198/pyHS2MF6/blob/master/example_models/standalone/HSPF/DC_Subs_12_mHSP2_PreAutoCal.h5">standalone mHSP2 input file</a>.</p>
<div class="align-center figure" id="id4">
<span id="fig-cs-sahspf"></span><a class="reference internal image-reference" href="_images/HSPF_Layout.png"><img alt="HSPF model layout" src="_images/HSPF_Layout.png" style="width: 800px;" /></a>
<p class="caption"><span class="caption-text"><strong>HSPF model configuration</strong></span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="calibration">
<span id="cs-sahspf-calib"></span><h3><span class="section-number">3.2.1.1. </span>Calibration<a class="headerlink" href="#calibration" title="Permalink to this headline">¶</a></h3>
<p>The goal for the standalone model is to produce Reach #5 outflow that
approximately represents the observed Dolan Creek stream flow discharge from
<a class="reference external" href="https://waterdata.usgs.gov/tx/nwis/uv/?site_no=08449100&amp;PARAmeter_cd=00065,00060">USGS Gage 08449100</a>.
In the set-up for calibration, estimates of spring discharge from Dolan
Springs and YR-70-01-701 (see Figure <a class="reference internal" href="cs_study_site.html#fig-cs-focused-ws"><span class="std std-ref">Springs and gage location</span></a>) are provided
to the HSPF model as an external time series of inflows to Reach #5.</p>
<p>An automated calibration process using <a class="reference external" href="http://www.pesthomepage.org/">PEST</a>
was used to tweak watershed parameters to best reproduce the observed
Dolan Creek stream flow. The results from this best-fit case are shown
on Figure <a class="reference internal" href="#fig-cs-sahspf-calib"><span class="std std-ref">Standalone HSPF Calibration</span></a>. In this figure, the orange shaded
area denotes the estimated, external inflow time series to Reach #5 that
represents the combination of Dolan Springs and YR-70-01-701 discharge.</p>
<div class="align-center figure" id="id5">
<span id="fig-cs-sahspf-calib"></span><a class="reference internal image-reference" href="_images/HSPF_SA_Calib.svg"><img alt="Standalone HSPF Calibration" src="_images/HSPF_SA_Calib.svg" width="800px" /></a>
<p class="caption"><span class="caption-text"><strong>Standalone HSPF Calibration</strong></span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="hspf-software-packages-and-conversion">
<span id="cs-sahspf-osoft"></span><h2><span class="section-number">3.2.2. </span>HSPF Software Packages and Conversion<a class="headerlink" href="#hspf-software-packages-and-conversion" title="Permalink to this headline">¶</a></h2>
<p>The standalone HSPF model was created using the following combinations
of HSPF-variant software.</p>
<ol class="arabic simple">
<li><p>The initial HSPF model set-up and configuration were implemented
using <a class="reference external" href="https://github.com/djlampert/PyHSPF">PyHSPF</a>. This produces
a HSPF <abbr title="User Control Interface">UCI</abbr> file and input and
output <abbr title="Watershed Data Management">WDM</abbr> files.</p></li>
<li><p><a class="reference external" href="https://github.com/respec/HSPsquared">HSPsquared</a> was then employed
to convert the <abbr title="User Control Interface">UCI</abbr> file and input
<abbr title="Watershed Data Management">WDM</abbr> file to an <cite>HSPsquared</cite>
input <a class="reference external" href="https://portal.hdfgroup.org/display/knowledge/What+is+HDF5">HDF5 file</a>.
This format is similar to what is required for <strong>mHSP2</strong>.</p></li>
<li><p>Next, the jupyter notebook
<a class="reference external" href="https://github.com/nmartin198/pyHS2MF6/blob/master/example_models/jupyter_notebooks/mHSP2_SetSaves.ipynb">mHSP2_SetSaves.ipynb</a>
was employed to modify the <cite>HSPsquared</cite>, input HDF5 file to be
provide the specification of model outputs that is required by <strong>mHSP2</strong>.</p></li>
</ol>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          
          <h3>Table of Contents</h3>
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">1. Getting Started with pyHS2MF6</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">2. Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="case_study.html">3. Coupled Mode Example Model</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="cs_study_site.html">3.1. Study Site</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">3.2. Standalone HSPF Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="cs_sa_MF6.html">3.3. Standalone MODFLOW 6 Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="cs_cpmode.html">3.4. Coupled Mode Simulation and Results</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="code_doc.html">4. Code Documentation</a></li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
            </form>
          </div>

        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="cs_study_site.html" title="3.1. Study Site"
              >previous</a> |
            <a href="cs_sa_MF6.html" title="3.3. Standalone MODFLOW 6 Model"
              >next</a> |
            <a href="py-modindex.html" title="Python Module Index"
              >modules</a> |
            <a href="f-modindex.html" title="Fortran Module Index"
              >fortran modules</a> |
            <a href="genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
              <br/>
              <a href="_sources/cs_sa_HSPF.rst.txt"
                rel="nofollow">Show Source</a>
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Nick Martin.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.1.2.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>